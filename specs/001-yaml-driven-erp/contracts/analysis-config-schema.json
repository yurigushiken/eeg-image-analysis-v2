{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AnalysisConfig",
  "type": "object",
  "required": ["dataset", "selection", "components", "preprocessing", "roi", "plots", "outputs"],
  "properties": {
    "dataset": {
      "type": "object",
      "required": ["root", "pattern", "montage_sfp"],
      "properties": {
        "root": {"type": "string"},
        "pattern": {"type": "string"},
        "montage_sfp": {"type": "string"}
      }
    },
    "selection": {
      "type": "object",
      "required": ["response", "min_epochs_per_set", "condition_sets"],
      "properties": {
        "response": {"type": "string", "enum": ["ALL", "ACC1"]},
        "min_epochs_per_set": {"type": "integer", "minimum": 1},
        "condition_sets": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["name", "conditions"],
            "properties": {
              "name": {"type": "string"},
              "conditions": {"type": "array", "items": {"type": "string", "pattern": "^[0-9]{2}$"}}
            }
          }
        }
      }
    },
    "components": {"type": "array", "items": {"type": "string", "enum": ["P1", "N1", "P3b"]}},
    "preprocessing": {
      "type": "object",
      "properties": {
        "baseline_ms": {"type": "array", "items": {"type": "integer"}, "minItems": 2, "maxItems": 2}
      }
    },
    "roi": {
      "type": "object",
      "properties": {"min_channels": {"type": "integer", "minimum": 1}}
    },
    "plots": {
      "type": "object",
      "properties": {
        "topomap_peak_window_ms": {"type": "integer", "minimum": 1},
        "peak_level": {"type": "string", "enum": ["cohort", "subject"]},
        "smoothing": {"type": "object"},
        "formats": {"type": "array", "items": {"type": "string"}},
        "dpi": {"type": "integer", "minimum": 50},
        "colors": {"type": "array", "items": {"type": "string"}},
        "linestyles": {"type": "object"}
      }
    },
    "outputs": {
      "type": "object",
      "required": ["plots_dir", "tables_dir", "page"],
      "properties": {
        "page": {"type": "string"},
        "plots_dir": {"type": "string"},
        "tables_dir": {"type": "string"}
      }
    }
  }
}

